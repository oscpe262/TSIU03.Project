The user interacts with the system through a PS/2-connected keyboard. The keyboard is then handled by the module \verb?Keyboard? which reads the scan codes, matches these against a \emph{one hot encoded} preset which makes up the \verb?kb_input? signal passed to \verb?Vol_Bal?.

The module inputs are \verb=PS2_DAT=, \verb=PS2_CLK=, \verb=clk= and \verb=rstn= which are used to shift in the scan code and compare the result with the preset, resulting in \verb=kb_input= --- a 5-bit unsigned value indicating if either of the arrow keys have been released. \verb=Vol_Bal= will then use this signal to adjust the volume and balance level. The Up/Down arrow keys controls the volume, and the Left/Right arrow keys controls the stereo channel balance.

The scan codes for the arrow keys consists of two (make code) or three (break code) bytes of information. These codes correspond to each other in the manner listed in figure \ref{fig:scancodes}. 

\begin{figure}[h]
\centering
\caption{PS/2 Scan Codes used and corresponding \texttt{kb\_input}}
\begin{tabular}{|c|c|c|c|}
\hline
KEY & MAKE & BREAK & \verb+kb_input+\\ \hline
U ARROW & E0,75 & E0,F0,75 & 00001\\ \hline
L ARROW & E0,6B & E0,F0,6B & 00010\\ \hline
D ARROW & E0,72 & E0,F0,72 & 00100\\ \hline
R ARROW & E0,74 & E0,F0,74 & 01000\\ \hline
END		& E0,69 & E0,F0,69 & 10000\\ \hline
\end{tabular}
\label{fig:scancodes}
\end{figure}

The scan codes are shifted into a 26-bit shift register which is reset to all ones, and once the start bit (0) is shifted out, the third byte (bit 23 \ldots 16) is NAND:ed with FF$_{16}$. A result of "1" then compared to the expected third byte of a released control key which on success sends a \verb+kb_input+ to \verb+Vol_Bal+.
